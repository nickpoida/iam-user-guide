# Варианты использования в бизнесе<a name="IAM_UseCases"></a>

Просто пример вариант использования IAM в бизнесе поможет вам понять основные способы реализации управления доступами ваших пользователей в AWS\. Этот вариант использования описан в общих терминах, без развернутого описания механики IAM API, которое вы будете использовать для достижения желаемых резульатов\. 

В этом сценарии использования рассматриваются два типичных способа использования IAM вымышленной компанией Example Corp\. В первом сценарии рассматривается Amazon Elastic Compute Cloud \(Amazon EC2\)\. А во втором - Amazon Simple Storage Service \(Amazon S3\)\. 

Для получения дополнительной информации об использовании IAM с другими сервисами AWS, ознакомьтесь с документом [Сервисы AWS которые работают с IAM](reference_aws-services-that-work-with-iam.md)\.

**Темы**
+ [Начальная настройка для Example Corp](#InitSetupExampleCorp_IAM)
+ [Вариант использования IAM с Amazon EC2](#UseCase_EC2)
+ [Вариант использования IAM с Amazon S3](#UseCase_S3)

## Начальная настройка для Example Corp<a name="InitSetupExampleCorp_IAM"></a>

Джон - основатель Example Corp\. С момента основания компании, он создает себе учетную запись AWS и самостоятельно использует продукты AWS\. Затем он нанимает сотрудников для работы в качестве разработчиков, администраторов, тестировщиков, менеджеров и системных администраторов.\. 

Джон использует консоль управления AWS Management Console с корневой(root) учетной записью AWS для создания себе пользователя *John* и группы *Admins*\. Он предоставляте группе Admins разрешения на выполнение всех действий со всеми ресурсами AWS в пределах учетной записи,используя встроенную политику [AdministratorAccess](https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/AdministratorAccess)\. Затем он добавляет пользователя John в группу Admins\. Пошаговое руководство по созданию группы администраторов и пользователя IAM для себя, а затем добавлению своего пользователя в группу администраторов см. в разделе [Создание первого административного пользователя и группы IAM](getting-started_create-admin-group.md)\. 

С этого момента Джон может перестать использовать корневые(root) учетные данные для работы с AWS, а, вместо этого, начать использовать свои личные учетные данные\.

Джон также создает группу *AllUsers* таким образом он может с лекгостью применять разрешения для всех пользователей в пределах аккаунта AWS\. Он добавляет себя в группу\. Затем он создает группу *Developers*, группу *Testers*, группу *Managers* и группу *SysAdmins*\. Он создает пользователей для каждого из сотрудников и помещает пользователей в соответствующие группы\. Кроме того, он добавляет их всех в группу AllUsers\. Для получения информации о создании групп, смотрите [Создание групп в IAM](id_groups_create.md)\. Для получения информации о создании пользователей, смотрите [Создание пользователя в IAM в аккаунте AWS](id_users_create.md)\. Для получения информации о добавлении пользователей в группы, смотрите [Управление группами IAM](id_groups_manage.md)\. 

## Вариант использования IAM с Amazon EC2<a name="UseCase_EC2"></a>

Такие компании, как Example Corp, обычно используют IAM для взаимодействия с такими сервисами, как Amazon EC2\. Для понимания этой части описания данного варианта использования, вам необходимо базовое понимание Amazon EC2\. Для получения информации об Amazon EC2, обратитесь к [Руководству пользователя по Amazon EC2 для использования инстансов с Linux](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/)\.

### Разрешения Amazon EC2 для групп<a name="EC2_PermissionsGroups"></a>

Для обеспечения контроля "периметра" Джон присоединяет политику к группе AllUsers\. Эта политика запрещает все запросы к AWS от пользователей, если его IP адрес не находится в пределах корпоративной сети Example Corp\.

В самой же Example Corp, разным группам необходимы разные разрешения:
+ **System administrators** – Необходимы разрешения создавать и управлять образами AMI, инстансами, мгновенными снимками, томами, группами безопасности и так далее\. Джон присоединяет встроенную управляему AWS политику `AmazonEC2FullAccess` к группе SysAdmins, что дает членам группы использовать все действия связанные с Amazon EC2\.
+ **Developers** – Необходима возможность работать только с инстансами\. Поэтому Джон создает и присоединяет политику к группе Developers, которая позволяет разработчикам совершать вызовы API `DescribeInstances`, `RunInstances`, `StopInstances`, `StartInstances` и `TerminateInstances`\. 
**Имейте ввиду**  
Amazon EC2 использует ключи SSH, пароли Windows и группы безопасности для контроля доступа к операционным системам на конкретных инстансах Amazon EC2\. Не существует методов в системе IAM для разрешения или запрета доступа к операционной системе конкретного инстанса\.
+ **Managers** – Не должны совершать каких либо действий связанных с Amazon EC2 за исключением просмотра доступных на текущий момент ресурсов Amazon EC2\. Поэтому Джон создает и присоединяет политику к группе Managers которая позволяет им вызывать операции API "Describe" в Amazon EC2\.

Для примеров того, как могут выглядить подобные политики смотрите [Примеры политик на основе идентификаторов IAM](access_policies_examples.md) и [Использование управления идентификацией и доступом AWS](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/index.html?UsingIAM.html) в *Руководстве пользователя по Amazon EC2 для использования инстансов с Linux*\.

### Изменение должности сотрудника<a name="EC2_UserRoleChange"></a>

В какой-то момент, один из разработчиков, Пауло, сменил должность и стал менеджером\. Джон переносит Пауло из группы Developers в группу  Managers\. Теперь, когда он попал в группу Managers, возможности Пауло по работе с инстансами Amazon EC2 ограничена\. Он не может создавать или запускать инстансы\. Также он не может останавливать или удалять существующие инстансы, даже если он сам был пользователем, который создал или запустил инстанс\. Он только может просматривать список инстансов, которые были созданы пользователями Example Corp\.

## Вариант использования IAM с Amazon S3<a name="UseCase_S3"></a>

Такие компании как Example Corp также обычно используют IAM с Amazon S3\. Джон создал для компании бакет Amazon S3 и назвал его *aws\-s3\-bucket*\.

### Создание других пользователей и групп<a name="S3_CreationOtherUsersGroups"></a>

Как сотрудники, Мэри и Жанг должны иметь возможность вносить свои данные в бакет компании\. Также им необходима возможность читать и записывать общие данные, над которыми работают все разработчики\. Чтобы обеспечить это, Джон логически распределяет данные в бакете aws\-s3\-bucket используя схему префиксов ключей, как показано ниже\.

```
/aws-s3-bucket
    /home
        /zhang
        /mary
    /share
        /developers
        /managers
```

Джон разбивает бакет `/aws-s3-bucket` в набор домашних директорий для каждого сотрудника, а также в общую область для разработчиков и менеджеров\.

Теперь Джон создает набор политик для того, чтобы назначить разрешения для пользователей и групп:
+ **Доступ в домашнюю директорию для Жанга** – Джон присоединияет политику Жангу, что позволит ему читать, записывать и просматривать любые объекты соотвествующие префиксу `/aws-s3-bucket/home/Zhang/` 
+ **Доступ в домашнюю директорию для Мэри** – Джон присоединяет политику Мэри, что позволяет ей читать, записывать и просмотривать любые объекты соответствующие префиксу`/aws-s3-bucket/home/mary/`
+ **Доступ в общую директорию для группы Developers** – Джон присоединяет политику к группе, таким образом позволяя разработчикам читать, записывать и просматривать любые объекты в `/aws-s3-bucket/share/developers/`
+ **Доступ в общую директорию для группы Managers** – Джон присоединяет политику к группе, таким образом позволяя менеджерам читать, записывать и просматривать любые объекты в `/aws-s3-bucket/share/managers/`

**Обратите внимание**  
Amazon S3 не дает автоматически пользователю, который создает бакет или объект, разрешение на выполнение других действий с этим бакетом или объектом\. Поэтому в политиках IAM вы должны явно предоставить пользователям разрешение на использование тех ресурсов Amazon S3, которые они создали\.

Для примера того, как могут выглядеть подобные политики, смотрите раздел [Контроль доступа](https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingAuthAccess.html) в *Руководстве разработчика Amazon Simple Storage Service*\. Для получения информации о том, как происходит оценка политики во время выполнения, смотрите [Логика оценки политик](reference_policies_evaluation-logic.md)\. 

### Изменение должности сотрудника<a name="S3_UserRoleChange"></a>

В какой-то момент, один из разработчиков, Жэнг меняет должность и становится менеджером\. Мы предполагаем, что ему более не нужен доступ к документам в директории `share/developers`\. Джон, как администратор, переносит Жэнга в группу `Managers` и исключает его из группы `Developers`\. Путем такого простого переназначения Жэнг автоматически получает все необходимые разрешения группы `Managers` и, в то же время, больше не имеет доступа к данным в директории `share/developers`\.

### Интеграция со сторонним бизнесом<a name="S3_3rdPartyBusiness"></a>

Организации часто работают с компаниями-партнерами, консультантами и подрядчиками\. У Example Corp есть партнер  - Widget Company и сотруднику Widget Company, Ширли необходимо положить данные в бакет для использования в Example Corp\. Джон создает группу *WidgetCo* и пользователя `Shirley`, после чего добавляет Shirley в группу WidgetCo\. Джон также создает специальный бакет *aws\-s3\-bucket1* для того, чтобы его могла использовать Ширли\.

Джон обновляет существующие политики или добавляет новые, чтобы предоставить доступ партнерской компании Widget\. Например, Джон может создать новую политику, которая запрещает членам группы WidgetCo любые действия, кроме записи\. Эта политика будет необходима, только если существует широкая политика, которая предоставляет всем пользователям доступ к широкому набору действий Amazon S3\.
